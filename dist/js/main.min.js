"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},curry=function(e){return function t(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.length>=e.length?e.apply(void 0,r):function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.apply(void 0,[].concat(r,n))}}},cloneObject=function(e){return JSON.parse(JSON.stringify(e))},mergeObjects=function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=n[0],i=n[1];n.length>2;){var a=n.splice(n.length-2,2);i=n[n.length-2]=e.apply(void 0,_toConsumableArray(a))}return"object"!==("undefined"==typeof o?"undefined":_typeof(o))||"object"!==("undefined"==typeof i?"undefined":_typeof(i))?"object"===("undefined"==typeof i?"undefined":_typeof(i))?i:o:(Object.keys(i).map(function(t){"object"===_typeof(i[t])&&o.hasOwnProperty(t)&&"object"===_typeof(o[t])&&(o[t]=e(o[t],i[t]),Object.keys(o[t]).length>Object.keys(i[t]).length&&(i[t]=cloneObject(o[t])))}),Object.assign(o,i))},fillArray=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return r=r.slice(),r.push(t),--n>0?e(cloneObject(t),n,r):r},buildArray=curry(fillArray),nextIndex=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t<e.length-1?++t:e.length-1},nextCell=function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}},bindPointData=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"z";return Object.keys(n).length||(n=point(0,0,0)),Array.isArray(t)?t.map(function(t,o){return n=mergeObjects(n,_defineProperty({},r,o)),e(t,n,r)}):"object"!==("undefined"==typeof t?"undefined":_typeof(t))||t.point?(t.point=cloneObject(n),t):Object.keys(t).map(function(r){return Array.isArray(t[r])?e(t[r],n,r):t[r]})},addElementStyles=function(e,t){return Object.keys(t).length&&e.style?Object.keys(t).forEach(function(n){return e.style[n]=t[n]}):e},generateElement=function(e){var t=document.createElement(e.type);return Object.keys(e).map(function(n){"type"!==n&&"styles"!==n&&t.setAttribute(n,e[n])}),e.styles&&addElementStyles(t,e.styles),t},appendElement=function(e,t){var n=e.splice(0,1),r=n[0],o=Array.isArray(r)?r.map(generateElement):generateElement(r);if(Array.isArray(r)){var i=function(){var n=!1;if(o.forEach(function(e){n&&n.appendChild(e),n=e}),e.length){var r=buildHTML(e,t,layer++);console.log(r),o[0].appendChild(r)}return{v:o[0]}}();if("object"===("undefined"==typeof i?"undefined":_typeof(i)))return i.v}if(o.style.zIndex=layer,Array.isArray(t)){if(console.log(e),e.length<2)return t.map(function(e){return e.element=o}),console.log(t),console.log(o),o;console.log(e.length),t.map(function(t){return o.appendChild(buildHTML(e,t,layer++))})}},buildHTML=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t.splice(0,1),i=o[0];console.log(t),console.log(i);var a=Array.isArray(i)?i.map(generateElement):generateElement(i);if(Array.isArray(i)){var l=function(){var o=!1;if(a.forEach(function(e){o&&o.appendChild(e),o=e}),t.length){var i=e(t,n,r++);console.log(i),a[0].appendChild(i)}return{v:a[0]}}();if("object"===("undefined"==typeof l?"undefined":_typeof(l)))return l.v}if(a.style.zIndex=r,Array.isArray(n)){if(console.log(t),t.length<2)return n.map(function(e){return e.element=a}),console.log(n),console.log(a),a;console.log(t.length),n.map(function(n){return a.appendChild(e(t,n,r++))})}return a},checkInBetween=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(o&&(r(e,n)||r(t,n)))return!0;var i=t.x-e.x,a=t.y-e.y,l=t.z-e.z;if(i>0){for(var u=e.x;u<t.x;++u)if(r({x:u,y:e.y,z:e.z},n))return!0}else if(a>0){for(var c=e.y;c<t.y;++c)if(r({x:e.x,y:c,z:e.z},n))return!0}else if(l>0)for(var s=e.z;s<t.z;++s)if(r({x:e.x,y:e.y,z:s},n))return!0;return!1},randCoords=function(e,t,n){return Math.floor(Math.random()*(e-(t-1)*n))},bindListeners=function e(t,n,r){for(var o=arguments.length,i=Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return Array.isArray(t)?t.map(function(t){return e.apply(void 0,[t,n,r].concat(i))}):t.element instanceof HTMLElement?t.element.addEventListener(n,function(){return r.apply(void 0,[t.point].concat(i))}):t.element},checkIfShipCell=function(e,t){return t[e.z][e.y][e.x].hasShip},buildShip=function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=ship(),a=t,l=0;l<e;++l)i.parts.push(setShip(r,a,o)),a=nextCell(a,n);return i},generateRandomFleet=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],o={x:t[0][0].length,y:t[0].length,z:t.length};for(var i in e){var a=point(1,0,0),l=point(0,0,0),u=point(0,0,0),c=e[i]<=o.z?1:0;do{switch(Math.floor(Math.random()*(2+c))){case 0:a=point(1,0,0);break;case 1:a=point(0,1,0);break;default:a=point(0,0,1)}l=point(randCoords(o.x,e[i],a.x),randCoords(o.y,e[i],a.y),randCoords(o.z,e[i],a.z)),u=point(l.x+a.x*(e[i]-1),l.y+a.y*(e[i]-1),l.z+a.z*(e[i]-1))}while(checkInBetween(l,u,t,checkIfShipCell));r.push(buildShip(e[i],l,a,t,n))}return r},randomFleet=curry(generateRandomFleet),point=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{x:e,y:t,z:n}},tile=function(){return{point:{},styles:{width:"35px",height:"35px",backgroundColor:"transparent"},element:{}}},matrix=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return buildArray(buildArray(buildArray(e,t),n),r)},coordinate=function(e){return{axis:e,element:{}}},newMatrix=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{z:buildArray(mergeObjects(coordinate("z"),{y:buildArray(mergeObjects(coordinate("y"),{x:buildArray(mergeObjects(coordinate("x"),e,o),t)},o),n)},o),r)}},square=function(e,t){return newMatrix(e,t,t)},cube=function(e,t){return newMatrix(e,t,t,t)},tableHTML=function(){return[[{type:"table",class:"matrix"},{type:"tbody"}],{type:"tr",class:"row"},{type:"td",class:"column"}]},gameTile=function(){return{hasShip:!1,isHit:!1,styles:{border:"1px solid #333",backgroundColor:"white",cursor:"pointer"}}},waterTile=function(){return mergeObjects(tile(),gameTile(),{styles:{backgroundColor:"blue"}})},shipTile=function(){return{hasShip:!0}},ship=function(){return{status:100,parts:[]}},hitTile=function(){return{isHit:!0}},boardHTML=function(){return[[{type:"div",class:"matrix"}],{type:"div",class:"layer",styles:{display:"inline-block",position:"relative",margin:"0 auto"}},{type:"div",class:"row",styles:{display:"flex"}},{type:"div",class:"column",styles:{display:"inline-block"}}]},playerSet=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{name:e,status:100,turnCnt:0,attacker:!1,attacks:{hit:0,miss:0,sunk:0},board:{},shipFleet:[]}},defaultFleet=randomFleet([5,4,3,3,2]),configureHtml=function(e){return e.isHit&&(e.styles.backgroundColor=e.hasShip?"red":"white"),addElementStyles(e.element,e.styles),e},recurseHtml=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=function(e){return nextIndex(t,e)};if(0===r){var a=function(){var r=Array.isArray(t[0])?t[0].map(generateElement):[];n.forEach(function(n){return r[r.length-1].appendChild(e(t,n,i(0),o++))});var a=!1;return r.forEach(function(e){a&&a.appendChild(e),a=e}),{v:r[0]}}();if("object"===("undefined"==typeof a?"undefined":_typeof(a)))return a.v}1===r&&t.length>2&&(t[1].styles.zIndex=o);var l=generateElement(t[r]);return Array.isArray(n)?(n.forEach(function(n){return l.appendChild(e(t,n,i(r),o))}),l):(n instanceof Object&&(n=configureHtml(mergeObjects(n,{element:l}))),l)},processHtml=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;return n.appendChild(recurseHtml(e,t))},generateHtml=curry(processHtml),createTable=generateHtml(boardHTML()),update3dCell=function(e,t,n,r,o){return configureHtml(mergeObjects(t[o][r][n],e))},alter3dCell=curry(update3dCell),setViewShip=alter3dCell(mergeObjects(shipTile(),{styles:{backgroundColor:"#777"}})),setHiddenShip=alter3dCell(shipTile()),setShip=function(e,t,n){return n?setViewShip(e,t.x,t.y,t.z):setHiddenShip(e,t.x,t.y,t.z)},setHit=alter3dCell(hitTile()),updatePlayer=function(e,t,n){e.attacker&&(t?++e.attacks.hit:++e.attacks.miss,n&&++e.attacks.sunk),t||(e.attacker=!e.attacker)},endGame=function(e){return[e]},nextAttacker=function(e,t,n,r,o,i){return r&&e.status>0?(updatePlayer(e,o,i),!r):e.attacker?(updatePlayer(e,o,i),t.length>1&&n>=t.length-1?(updatePlayer(t[0],o,i),r):!r):r},updateScore=function(e,t,n,r,o){e.status<=0&&o.push(e),r=r.filter(function(e){return e.status>0});var i=!1;return r.map(function(e,o){return i=nextAttacker(e,r,o,i,t,n),r.length<2?endGame(r[0]):e})},attackFleet=function(e,t,n,r,o){if(n.status<=0||n.attacker)return r;var i=setHit(t,e.x,e.y,e.z),a={};if(i.hasShip){var l=0;n.shipFleet.map(function(t){if(t.hasOwnProperty("parts")){var n=t.parts.filter(function(n){return n.point===e&&(a=t),!n.isHit});t.status=n.length/t.parts.length*100}return l+=t.status,t}),n.status=l/n.shipFleet.length}var u=a.status<=0?a.parts.length:0;return updateScore(n,i.hasShip,u,r,o)},launchAttack=curry(attackFleet);!function(){var e=[],t=function(e){for(var t=[],n=!0,r=0;r<e;++r){var o=playerSet();o.attacker=n,n=!1;var i=square(waterTile(),10);console.log(i),o.board=bindPointData(i)}return t},n=t(1);console.log(n),console.log(e)}();