"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},curry=function(e){return function t(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=e.length?e.apply(void 0,r):function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(void 0,[].concat(r,n))}}},mapObject=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)?e.map(function(e,n){return 1===t.length?t(e):t(e,n)}):Object.keys(e).reduce(function(n,r){return n[r]=1===t.length?t(e[r]):t(e[r],r),n},n)},filterObject=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)?e.filter(function(e,n){return 1===t.length?t(e):t(e,n)}):Object.keys(e).reduce(function(n,r){return(1===t.length?t(e[r]):t(e[r],r))?n[r]=e[r]:delete n[r],n},n)},reduceObject=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)?e.reduce(t,n):Object.keys(e).reduce(function(n,r){return t(n,e[r])},n)},notEmptyObjectOrArray=function(e){return!!("object"===(void 0===e?"undefined":_typeof(e))&&Object.keys(e).length||Array.isArray(e)&&e.length)},cloneObject=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return cloneExclusions(JSON.parse(JSON.stringify(e,function(e,n){return removeCircularReference(e,n,t)})),e,t=[])},inArray=function(e,t){return e.indexOf(t)>=0},removeCircularReference=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("object"===(void 0===t?"undefined":_typeof(t))){if(inArray(n,t))return;n.push(t)}return t},recursiveMap=function(e,t,n){for(var r=arguments.length,i=Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];return function(r,a){return t(r,a)?r:n.apply(void 0,[e[a],r].concat(i))}},cloneRules=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return!e[r]||n instanceof HTMLElement||"parentItem"===r||"listenerArgs"===r||!!t&&t(n,r)}},cloneExMap=function(e,t,n,r){return mapObject(t,recursiveMap(e,cloneRules(e,curry(inArray)(n.concat([t]))),r,n.concat([t])))},cloneExclusions=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return notEmptyObjectOrArray(n)?cloneExMap(t,n,r,e):t},mergeObjects=function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return 2===n.length?notEmptyObjectOrArray(n[1])?mapObject(n[1],recursiveMap(n[0],cloneRules(n[0]),e),cloneObject(n[0])):n[1]:1===n.length?cloneObject(n[0]):n.reduce(function(t,n){return e(t,n)},{})},mergeObjectsMutable=function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return 2===n.length?notEmptyObjectOrArray(n[1])?mapObject(n[1],recursiveMap(n[0],cloneRules(n[0]),e),n[0]):n[1]:1===n.length?n[0]:n.reduce(function(t,n){return e(t,n)},{})},buildArray=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return--n>0?e(r?t:cloneObject(t),n,r,i.concat([t])):i.concat([t])},queueTimeout=function e(){for(var t=arguments.length,n=Array(t>2?t-2:0),r=2;r<t;r++)n[r-2]=arguments[r];var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.queue=e.queue||[],e.isRunning=e.isRunning||!1;var u={id:0,func:i,timeout:a,args:n,result:0};if(i&&e.queue.push(u),e.queue.length&&!e.isRunning){e.isRunning=!0;var o=e.queue.shift();return o.id=setTimeout(function(){return o.result=o.func.apply(o,_toConsumableArray(o.args)),e.isRunning=!1,e(!1)},o.timeout),o}return u},DOMItem=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return mergeObjectsMutable.apply(void 0,[{tagName:"div",attributes:{styles:{}},element:{},eventListeners:{},parentItem:{},children:[]}].concat(t))},initChildren=function(){return[DOMItem({tagName:"head",attributes:{},element:document.head,children:[]}),DOMItem({tagName:"body",attributes:{},element:document.body,children:[]})]},initRoot=function(e){return DOMItem({tagName:"html",attributes:{},element:document,children:e,head:e[0],body:e[1]})},documentDOMItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initRoot(initChildren());return DOMItem(e,{children:e.children.map(function(t){return DOMItem(t,{parentItem:e})})})},documentItem=documentDOMItem(),elementHasAttribute=function(e,t,n){return e instanceof HTMLElement&&(t in e?e[t]===n:"styles"===t?Object.keys(n).filter(function(t){return!inArray(Object.keys(e.style),t)||n[t]!==e.style[t]}).concat(Object.keys(e.style)).reduce(function(t,r){return t[r]=inArray(Object.keys(n),r)?inArray(Object.keys(e.style),r)?1:0:-1,t},{}):"class"===t?n.split(" ").filter(function(t){return!inArray(e.className.split(" "),t)}).concat(e.className.split(" ")).filter(function(e){return!!e.length}).reduce(function(t,r){return t[r]=inArray(n.split(" "),r)?inArray(e.className.split(" "),r)?1:0:-1,t},{}):e.hasAttribute(t)&&e.getAttribute(t)===n)},elementChanges=function(e){return e.element.tagName.toLowerCase()!==e.tagName.toLowerCase()?generateElement(e):(e.attributes=filterObject(e.attributes,function(t,n){return filterObject(mapObject(e.attributes,function(t,n){return"object"===(void 0===t?"undefined":_typeof(t))||"class"===n?filterObject(elementHasAttribute(e.element,n,t),function(e){return!e}):!elementHasAttribute(e.element,n,t)}),function(e){return!!e})[n]}),e)},updateElement=function(e){return e.element instanceof HTMLElement&&(e.attributes=mapObject(elementChanges(e).attributes,function(t,n){return n in e.element?(e.element[n]=t,t):"styles"===n?(e.attributes.styles=mapObject(t,function(t,n){return e.element.style[n]=t},e.element.style),t):"class"===n?(e.element.className=t,t):(e.element.setAttribute(n,t),t)})),e},updateElements=function e(t){(t=updateElement(t)).children.map(function(t){return e(t)})},generateElement=function(e){return e.element=document.createElement(e.tagName),updateElement(e)},bindAllElements=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:documentItem;return mapObject(DOMItem(t),function(e){return e},t),t.element=t.element&&t.element instanceof HTMLElement?t.element:bindElement(t).element,t.parentItem=n.body||n,t.children.map(function(n){return e(n,t)}),t},bindElement=function(e){return e.element&&e.element instanceof HTMLElement||(e.element=generateElement(e).element),e},buildHTML=function e(t){return t.children.map(function(n){return t.element.appendChild(e(n).element)}),t},appendAllHTML=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:documentItem.body,n=t.body?t.body:t;return inArray(n.children,e)||n.children.push(e),buildHTML(n)},appendHTML=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:documentItem.body,n=t.body?t.body:t;return inArray(n.children,e)||n.children.push(e),e.element&&e.element instanceof HTMLElement||(e=bindElement(e)),n.element.appendChild(e.element),e},removeChild=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:documentItem.body;return t.element.removeChild(e.element),t.children.splice(t.children.indexOf(e),1)},listenerOptions=function e(t){if(void 0===e.supportsOptions){e.supportsOptions=!0;try{window.addEventListener("test",null,{capture:!1,once:!1,passive:!1})}catch(t){e.supportsOptions=!1}}return!("object"!==(void 0===t?"undefined":_typeof(t))||!e.supportsOptions)&&t},assignListener=function(e,t,n,r){return t.addEventListener?t.addEventListener(e,n,listenerOptions(r)):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n,n},appendListeners=function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return t.children=t.children||[],t.eventListeners&&t.eventListeners[n]&&(t.eventListeners[n]={listenerFunc:r,listenerArgs:i,listenerOptions:a}),t.children.map(function(t){return e(t,n,r,i,a)}),t},bindAllListeners=function e(t){return t.eventListeners&&Object.keys(t.eventListeners).length&&t.element instanceof HTMLElement&&mapObject(t.eventListeners,function(e,n){return assignListener(n,t.element,function(n){return e.listenerFunc(n,t,e.listenerArgs)},e.listenerOptions)}),t.children=t.children.map(function(t){return e(t)}),t},bindListeners=function(e){return e.eventListeners&&Object.keys(e.eventListeners).length&&e.element instanceof HTMLElement&&mapObject(e.eventListeners,function(t,n){return assignListener(n,e.element,function(n){return t.listenerFunc(n,e,t.listenerArgs)},t.listenerOptions)}),e},getChildrenFromAttribute=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:documentItem.body;return r.attributes[t]&&r.attributes[t]===n?r.children.reduce(function(r,i){return r.concat(e(t,n,i))},[]).concat([r]):r.children.reduce(function(r,i){return r.concat(e(t,n,i))},[])},getChildrenByClass=curry(getChildrenFromAttribute)("class"),getChildrenByName=curry(getChildrenFromAttribute)("name"),getParentsFromAttribute=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:documentItem.body;return Object.keys(r.parentItem).length?r.attributes[t]&&r.attributes[t]===n?e(t,n,r.parentItem).concat([r]):e(t,n,r.parentItem):[]},getParentsByClass=curry(getParentsFromAttribute)("class"),getParentsByName=curry(getParentsFromAttribute)("name"),getTopParentItem=function e(t){return Object.keys(t.parentItem).length?e(t.parentItem):t},renderHTML=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:documentItem;return mapObject(DOMItem(t),function(e){return e},t),t.element=t.element&&t.element instanceof HTMLElement?t.element:bindElement(t).element,t.parentItem=n.body||n,(t=bindListeners(appendHTML(t,n))).children.map(function(n){return e(n,t)}),t},point=function(e,t){return{x:e,y:t,z:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0}},tile=function(){return{point:{}}},coordinate=function(e){return{axis:e}},matrix=function(e,t,n){for(var r=arguments.length,i=Array(r>4?r-4:0),a=4;a<r;a++)i[a-4]=arguments[a];var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return DOMItem({tagName:"div",attributes:{class:"matrix"},children:buildArray(DOMItem.apply(void 0,[coordinate("z"),{tagName:"div",attributes:{class:"layer"},children:buildArray(DOMItem.apply(void 0,[coordinate("y"),{tagName:"div",attributes:{class:"row"},children:buildArray(DOMItem.apply(void 0,[coordinate("x"),{tagName:"div",attributes:{class:"column"}}].concat(i,[e])),t)}].concat(i)),n)}].concat(i)),u)})},square=function(e,t){return matrix(e,t,t)},cube=function(e,t){return matrix(e,t,t,t)},bindPointData=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:point(0,0,0);return mergeObjects(t,t.point?{point:cloneObject(n)}:{children:t.children.map(function(t,r){return e(t,mergeObjects(n,_defineProperty({},t.axis,r)))})})},nextCell=function(e,t){return point(e.x+t.x,e.y+t.y,e.z+t.z)},pointDifference=function(e,t){return point(t.x-e.x,t.y-e.y,t.z-e.z)},checkEqualPoints=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},pointDirection=function(e,t){var n=pointDifference(e,t),r=!!Object.keys(filterObject(n,function(e,t){return e<0})).length,i=reduceObject(n,function(e,t){return r&&t<e||!r&&t>e?t:e},0),a=Object.keys(n).filter(function(e){return n[e]===i})[0],u=point(0,0,0);return u[a]=r?-1:1,u},getPointsLine=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return checkEqualPoints(t,n)?r.concat([t]):e(nextCell(t,pointDirection(t,n)),n,r.concat([t]))},testPointsBetween=function(e,t,n,r){return getPointsLine(e,t).reduce(function(e,t){return e[""+!!r(t,n)].push(t),e},{true:[],false:[]})},getInBetween=function(e,t,n,r){var i={true:[],false:[]};return(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&(r(e,n)?i.true.push(e):i.false.push(e),r(t,n)?i.true.push(t):i.false.push(t)),mergeObjects(i,testPointsBetween(e,t,n,r))},checkInBetween=function(e,t,n,r){return!(!(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])||!r(e,n)&&!r(t,n))||!!testPointsBetween(e,t,n,r).true.length},getAxisLengths=function(e){return point(e.children[0].children[0].children.length,e.children[0].children.length,e.children.length)},randCoords=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.floor(Math.random()*(e-(t-1)*n))},randDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length?e[Math.floor(Math.random()*e.length)]:point(0,0,0)},checkValidPoint=function(e,t){return!!(t.children[e.z]&&t.children[e.z].children[e.y]&&t.children[e.z].children[e.y].children[e.x]&&t.children[e.z].children[e.y].children[e.x].point)},getDOMItemFromPoint=function(e,t){return!!checkValidPoint(e,t)&&t.children[e.z].children[e.y].children[e.x]},getAllPoints=function(e){for(var t=getAxisLengths(e),n=[],r=0;r<t.z;++r)for(var i=0;i<t.y;++i)for(var a=0;a<t.x;++a)n.push(e.children[r].children[i].children[a].point);return n},adjacentPoints=function(e,t){for(var n=[],r=-1;r<2;++r)for(var i=-1;i<2;++i)for(var a=-1;a<2;++a){var u=point(e.x+a,e.y+i,e.z+r);checkValidPoint(u,t)&&point!==u&&n.push(u)}return n},adjacentEdgePoints=function(e,t){return[point(-1,0,0),point(1,0,0),point(0,-1,0),point(0,1,0),point(0,0,-1),point(0,0,1)].map(function(t){return point(e.x+t.x,e.y+t.y,e.z+t.z)}).filter(function(e){return checkValidPoint(e,t)})},mainMenu=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{tagName:"div",attributes:{class:"main-menu"},children:[{tagName:"div",attributes:{class:"content"},children:[{tagName:"form",attributes:{class:"main-menu-form"},eventListeners:{submit:{listenerFunc:beginRound,listenerArgs:{},listenerOptions:!1}},children:[{tagName:"div",attributes:{class:"form-group"},children:[{tagName:"label",attributes:{for:"human-players",innerText:"Humans"}},{tagName:"input",attributes:{id:"human-players",name:"human-players",type:"number",value:0,min:0,max:100,required:""}}]},{tagName:"div",attributes:{class:"form-group"},children:[{tagName:"label",attributes:{for:"robot-players",innerText:"Robots"}},{tagName:"input",attributes:{id:"robot-players",name:"robot-players",type:"number",value:0,min:0,max:100,required:""}}]},{tagName:"label",attributes:{for:"first-go-first",innerText:"First Player Starts"}},{tagName:"input",attributes:{id:"first-go-first",name:"first-go-first",type:"checkbox"}},{tagName:"input",attributes:{type:"submit",value:"Start"}}]}]}]}},boards=function(){return{tagName:"div",attributes:{class:"boards"},children:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}},finalScore=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{tagName:"div",attributes:{class:"final-scores"},children:[{tagName:"div",attributes:{class:"score-cards"},children:e.map(function(e){return{tagName:"div",attributes:{class:"score-card",innerHTML:"<strong>"+e.name+"</strong><hr><br></strong><strong>Status:</strong> "+Math.round(100*e.status)/100+"%, <strong>Sunk:</strong> "+e.attacks.sunk+"<br><strong>Hit:</strong> "+e.attacks.hit+" / <strong>Miss:</strong> "+e.attacks.miss+"<br><strong>Turns:</strong> "+e.turnCnt}}})},{tagName:"input",attributes:{type:"button",value:"Restart"},eventListeners:{click:{listenerFunc:restart,listenerArgs:{},listenerOptions:!1}}}]}},checkIfShipCell=function(e,t){return t.children[e.z].children[e.y].children[e.x].hasShip},checkIfHitCell=function(e,t){return t.children[e.z].children[e.y].children[e.x].isHit},getAllNonHitCells=function(e){return getAllPoints(e).filter(function(t){return!checkIfHitCell(t,e)})},getAdjNonHitCells=function(e,t){return adjacentPoints(e,t).filter(function(e){return!checkIfHitCell(e,t)})},getAdjEdgeNonHitCells=function(e,t){return adjacentEdgePoints(e,t).filter(function(e){return!checkIfHitCell(e,t)})},getALowStatusItem=function(e){return e.reduce(function(e,t){return t.status<=e.status?t:e})},getLowStatusItems=function(e){return e.filter(function(t){return t.status<=getALowStatusItem(e).status})},getBrokenItems=function(e){return e.filter(function(e){return e.status<100&&e.status>0})},getBrokenShipsPlayers=function(e){return e.filter(function(e){return getBrokenItems(e.shipFleet).length})},numDamangedParts=function(e,t){return e-Math.ceil(t/100*e)},filterAdjacentPoints=function(e){return e.z%2==0&&(e.x%2==0&&e.y%2==0||e.x%2!=0&&e.y%2!=0)||e.z%2!=0&&(e.x%2!=0&&e.y%2==0||e.x%2==0&&e.y%2!=0)},buildShip=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=ship(e.name),u=t,o=0;o<e.size;++o)a.parts.push(setShip(r,u,i)),u=nextCell(u,n);return a},generateStartDir=function e(t,n,r,i){var a=randDirection(i),u=point(randCoords(r.x,n,a.x),randCoords(r.y,n,a.y),randCoords(r.z,n,a.z)),o=point(u.x+a.x*(n-1),u.y+a.y*(n-1),u.z+a.z*(n-1));return checkInBetween(u,o,t,checkIfShipCell)?e(t,n,r,i):{start:u,dir:a}},generateRandomFleet=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=getAxisLengths(t);for(var a in e){point(0,0,0),point(0,0,0);var u=[];if(e[a].size<=i.x&&u.push(point(1,0,0)),e[a].size<=i.y&&u.push(point(0,1,0)),e[a].size<=i.z&&u.push(point(0,0,1)),u.length){var o=generateStartDir(t,e[a].size,i,u);r.push(buildShip(e[a],o.start,o.dir,t,n))}}return r},buildPlayers=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t<1&&n<1)return r;var i=playerSet({},"Player "+(r.length+1));return i.isRobot=t<=0,i.board=bindPointData(square(waterTile(i,r),10)),i.shipFleet=defaultFleet(i.board,!1),i.playerStats=playerStats(i,Math.round(100*i.status)/100+"%"),i.children=[i.board,i.playerStats],r.push(i),e(--t,t<0?--n:n,r)},beginRound=function(e,t){e.preventDefault();var n=getTopParentItem(t),r=parseInt(getChildrenByName("human-players",t)[0].element.value),i=parseInt(getChildrenByName("robot-players",t)[0].element.value);if(r<0||r>100||i<0||i>100)return!1;var a=getChildrenByName("first-go-first",t)[0].element.checked;0===(r=r<0?0:r)&&(i=i<2?2:i),1===r&&(i=i<1?1:i),removeChild(getChildrenByClass("main-menu",n.body)[0],n.body);var u=renderHTML(boards(buildPlayers(r,i)),n).children,o=updatePlayer(a?u[0]:u[Math.floor(Math.random()*u.length)]);return o.isRobot&&computerAttack(o,u),!1},main=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:documentItem,t=e.body.children.length-1;t>=0;--t)removeChild(e.body.children[t],e.body);return renderHTML(mainMenu(),e),e},restart=function(e,t){return main(getTopParentItem(t))},gameTile=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{hasShip:!1,isHit:!1,eventListeners:{click:{listenerFunc:attackListener,listenerArgs:{},listenerOptions:!1}}}},waterTile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return mergeObjects(gameTile(e,t),tile())},shipTile=function(){return{hasShip:!0}},ship=function(){return{name:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",status:100,parts:[]}},hitTile=function(){return{isHit:!0}},playerSet=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",isRobot:!1,status:100,turnCnt:0,attacker:!1,attacks:{hit:0,miss:0,sunk:0},board:e,shipFleet:[],playerStats:{},tagName:"div",attributes:{class:"player"},children:[e]}},playerStats=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{tagName:"div",attributes:{},children:[{tagName:"span",attributes:{innerHTML:"<strong>"+e.name+"</strong>: "+t}},{tagName:"ul",attributes:{},children:e.shipFleet.map(function(e){return{tagName:"li",attributes:{innerHTML:"<strong>"+e.name+" ("+e.parts.length+"):</strong> "+Math.round(100*e.status)/100+"%"}}})}]}},defaultFleet=curry(generateRandomFleet)([{name:"Aircraft Carrier",size:5},{name:"Battleship",size:4},{name:"Submarine",size:3},{name:"Cruiser",size:3},{name:"Destroyer",size:2}]),selectTargetPlayer=function(e){var t=getBrokenShipsPlayers(e).length?getBrokenShipsPlayers(e):getLowStatusItems(e);return 1===t.length?t[0]:t[Math.floor(Math.random()*t.length)]},selectTargetCoord=function(e){var t=getBrokenItems(e.shipFleet),n=[];if(t.length){var r=t.filter(function(e){return numDamangedParts(e.parts.length,e.status)>1}),i=getALowStatusItem(r.length?r:t).parts.filter(function(t){return checkIfHitCell(t.point,e.board)});if(r.length){for(var a=0;a<i.length;++a){var u=getInBetween(i[0].point,i[a].point,e.board,checkIfHitCell,!1);if(u.false.length)return displayTargets(u.false,u.false[0],e),getDOMItemFromPoint(u.false[0],e.board)}var o=(pointDifference(i[0].point,i[1].point).x>0?[point(-1,0,0),point(1,0,0)]:[point(0,-1,0),point(0,1,0)]).map(function(e,t){return nextCell(i[(i.length-1)*t].point,e)}).filter(function(t){return checkValidPoint(t,e.board)}).filter(function(t){return!checkIfHitCell(t,e.board)}),l=o.reduce(function(t,n){return checkIfHitCell(t,e.board)?n:t});if(l)return displayTargets(o,l,e),getDOMItemFromPoint(l,e.board)}n=getAdjEdgeNonHitCells(i[0].point,e.board)}var s=n.length?n:getAllNonHitCells(e.board).filter(function(e){return filterAdjacentPoints(e)}),c=s[Math.floor(Math.random()*s.length)];return displayTargets(s,c,e),getDOMItemFromPoint(c,e.board)},displayTargets=function(e,t,n){return[queueTimeout(resetTargets,0,{targets:e,victim:n}),queueTimeout(resetTargets,400,{targets:e,target:t,victim:n})]},resetTargets=function(e){return e.victim.board.children.map(function(e){return updateElement(mergeObjects(e,{attributes:{styles:{borderColor:"#333"}}}))}),e.targets.forEach(function(t){return updateElement(mergeObjects(getDOMItemFromPoint(t,e.victim.board),{attributes:{styles:{borderColor:"#333"}}}))}),e.target?setHit(e.victim.board,e.target.x,e.target.y,e.target.z,e.victim.isRobot):(e.victim.board.children.map(function(e){return updateElement(mergeObjects(e,{attributes:{styles:{borderColor:"yellow"}}}))}),e.targets.forEach(function(t){return updateElement(mergeObjects(getDOMItemFromPoint(t,e.victim.board),{attributes:{styles:{borderColor:"yellow"}}}))}),e)},computerAttack=function(e,t){var n=selectTargetPlayer(t.filter(function(e){return!e.attacker}));return attackFleet.isLocked=!1,attackFleet(selectTargetCoord(n))},configureHtml=function(e,t){return t?(attackFleet.isLocked=!0,queueTimeout(function(){return e.isHit&&(e.attributes.styles.backgroundColor=e.hasShip?"red":"white"),e=updateElement(e),attackFleet.isLocked=!1,e},0)):(e.isHit&&(e.attributes.styles.backgroundColor=e.hasShip?"red":"white"),e=updateElement(e)),e},update3dCell=function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return configureHtml(mergeObjectsMutable(t.children[i].children[r].children[n],e),a)},setViewShip=curry(update3dCell)(mergeObjects(shipTile(),{attributes:{styles:{backgroundColor:"#777"}}})),setHiddenShip=curry(update3dCell)(shipTile()),setHit=curry(update3dCell)(hitTile()),setShip=function(e,t,n){return n?setViewShip(e,t.x,t.y,t.z):setHiddenShip(e,t.x,t.y,t.z)},updatePlayerStats=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.round(100*e.status)/100+"%";return e.playerStats=mergeObjects(e.playerStats,playerStats(e,t)),updateElements(e.playerStats),e},updatePlayer=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.attacker&&(t?++e.attacks.hit:++e.attacks.miss,n&&++e.attacks.sunk);return t||(e.attacker=!e.attacker,attackFleet.isLocked=!0,e.attacker?(queueTimeout(function(){return attackFleet.isLocked=!1,e.board.children.map(function(e){return e.children.map(function(e){return e.children.map(function(e){return updateElement(mergeObjects(e,{attributes:{styles:{width:"17px",height:"17px"}}}))})})})},400),++e.turnCnt):queueTimeout(function(){return attackFleet.isLocked=!1,e.board.children.map(function(e){return e.children.map(function(e){return e.children.map(function(e){return updateElement(mergeObjects(e,{attributes:{styles:{width:"35px",height:"35px"}}}))})})})},0)),queueTimeout(function(){return updatePlayerStats(e,e.attacker?"ATTACKER":Math.round(100*e.status)/100+"%")},0).result||e},endGame=function(e){var t=getTopParentItem(e),n=e.parentItem.children;return n.map(function(e){return updatePlayerStats(e)}),e=updatePlayerStats(e,"WINNER"),renderHTML(finalScore(n),t),[e]},findNextAttacker=function e(t,n,r){var i=n.length>1&&r>=n.length-1?n[0]:n[++r];return i.status>0?i:e(t,n,r)},getNextAttacker=function(e,t,n){return n?e:updatePlayer(findNextAttacker(e,t,t.indexOf(e)),n)},updateScore=function(e,t,n,r,i){var a=(r=r.filter(function(e){return e.status>0})).reduce(function(e,t){return e.attacker?e:t});if(a=updatePlayer(a,t,n),r.length<2)return queueTimeout(function(){return endGame(r[0])},400);var u=getNextAttacker(a,r,t);return u.isRobot&&queueTimeout(computerAttack,0,u,r),r},attackFleet=function e(t){e.isLocked=e.isLocked||!1;var n=getParentsByClass("player",t)[0],r=getParentsByClass("boards",t)[0].children;if(n.status<=0||n.attacker||e.isLocked)return r;var i=setHit(n.board,t.point.x,t.point.y,t.point.z,r.reduce(function(e,t){return e.attacker?e:t}).isRobot),a=!1,u=0;if(i.hasShip){var o=0;n.shipFleet.map(function(e){var n=e.parts.filter(function(n){return checkEqualPoints(n.point,t.point)&&(a=e),!n.isHit});return e.status=n.length/e.parts.length*100,o+=e.status,e}),n.status=o/n.shipFleet.length}return a&&(n=updatePlayerStats(n,Math.round(100*n.status)/100+"%"),u=a.status<=0?a.parts.length:0),updateScore(n,i.hasShip,u,r,t.point)},attackListener=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return attackFleet(t)};!function(){var e=main(documentDOMItem());console.log(e)}();